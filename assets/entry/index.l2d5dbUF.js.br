import{i as e,g as a,a as t,b as i,c as n,d as l,r as c,o as r,j as s,s as o,e as d,f as m,u as h,A as u,m as _,R as p,h as y,F as v,k as f,l as g,n as k,p as b,q as N,t as w,v as x,w as $,x as A,y as C,z as B,B as S,C as D,D as E,E as I,G as O,H as P,L as T,I as F,J as G,K as V,M as j,N as q,O as M,P as L,Q as H,S as U,T as z}from"../chunks/vendor.DQbLfDJ_.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const R=window.location.hostname.includes("github.io"),W=e({apiKey:"AIzaSyAdoHJO1oTPXk1Zu4OU-RkkNtGZ3t_pnI0",authDomain:"scdatabase-cd5e8.firebaseapp.com",projectId:"scdatabase-cd5e8",storageBucket:"scdatabase-cd5e8.firebasestorage.app",messagingSenderId:"768146457748",appId:"1:768146457748:web:3ce6f73a359aa8d2aca081",measurementId:"G-FQBL9RWTHT"}),Z=a(W);let J=null;try{t().then((e=>{e&&(J=i(W))}))}catch(la){}const K=n(W);if(l(W),R)try{K.l={ignoreUndefinedProperties:!0,cacheSizeBytes:4e7,experimentalForceLongPolling:!0,experimentalAutoDetectLongPolling:!0}}catch(la){}const Q=c.createContext(),X=({children:e})=>{const[a,t]=c.useState(null),[i,n]=c.useState(!0);c.useEffect((()=>r(Z,(e=>{t(e),n(!1)}))),[]);const l={currentUser:a,signup:async(e,a,t)=>{const i=await m(Z,e,a);return await h(i.user,{displayName:t}),i.user},login:(e,a)=>d(Z,e,a),logout:()=>o(Z)};return s.jsx(Q.Provider,{value:l,children:!i&&e})},Y="_text-animation_19xob_217",ee={window:"_window_bq3fc_2",window__message:"_window__message_bq3fc_12",window__panel:"_window__panel_bq3fc_22",window__panel__iconWrapper:"_window__panel__iconWrapper_bq3fc_34",window__panel__navButtons:"_window__panel__navButtons_bq3fc_39",window__panel__navButtons__navButton:"_window__panel__navButtons__navButton_bq3fc_44",window__panel__navButtons__navButton__arrow:"_window__panel__navButtons__navButton__arrow_bq3fc_49",disabled:"_disabled_bq3fc_60"},ae=({children:e,direction:a,selectedIcon:t,showMessage:i=!0})=>s.jsx(u,{mode:"wait",custom:a,children:t?s.jsx(_.div,{custom:a,initial:{opacity:0,x:a>0?100:-100},animate:{opacity:1,x:0},exit:{opacity:0,x:a>0?-100:100},transition:{duration:.3},layout:!0,style:{width:"100%",height:"100%"},children:e},t):i&&s.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:s.jsx("div",{className:ee.window__message,children:s.jsx("h2",{children:"Выберите персонажа"})})},"message")}),te={menu:"_menu_15kr5_2",menu__left:"_menu__left_15kr5_14",menu__left__pic:"_menu__left__pic_15kr5_24",menu__right:"_menu__right_15kr5_35",menu__right__titleblock:"_menu__right__titleblock_15kr5_52",menu__right__titleblock__fullname:"_menu__right__titleblock__fullname_15kr5_60",menu__right__titleblock__maininfo:"_menu__right__titleblock__maininfo_15kr5_63"};function ie(e){if(!Number.isInteger(e)||e<0)throw new Error("Возраст должен быть неотрицательным целым числом");const a=e%10,t=e%100;return t>=11&&t<=19?"лет":1===a?"год":a>=2&&a<=4?"года":"лет"}const ne={button:"_button_1jwbf_1",icon:"_icon_1jwbf_39"},le=({text:e})=>s.jsx(s.Fragment,{children:e.split("").map(((e,a)=>{const t=" "===e?" ":e;return s.jsx("span",{style:{animationDelay:.05*a+"s"},children:t},a)}))}),ce={modalOverlay:"_modalOverlay_1iw7e_2",modalOverlay__content:"_modalOverlay__content_1iw7e_15",modalOverlay__closeButton:"_modalOverlay__closeButton_1iw7e_29",modalOverlay__textContent:"_modalOverlay__textContent_1iw7e_42",modalOverlay__navigation:"_modalOverlay__navigation_1iw7e_48",modalOverlay__arrowRight:"_modalOverlay__arrowRight_1iw7e_54",modalOverlay__arrowLeft:"_modalOverlay__arrowLeft_1iw7e_54",modalOverlay__title:"_modalOverlay__title_1iw7e_67",modalOverlay__textBlock:"_modalOverlay__textBlock_1iw7e_86",modalOverlay__textBlock__textCont:"_modalOverlay__textBlock__textCont_1iw7e_89",modalOverlay__pageIndicator:"_modalOverlay__pageIndicator_1iw7e_104",fadeIn:"_fadeIn_1iw7e_116",fadeOut:"_fadeOut_1iw7e_120",disabled:"_disabled_1iw7e_124"},re=e=>e&&"string"==typeof e?e.replace(/class=/g,"className="):"",se=e=>{if(!e||"string"!=typeof e)return[];if(!/<p>.*?<\/p>/g.test(e))return[`<p>${e}</p>`];if("undefined"==typeof window)return[e];const a=e.split("<p>").filter(Boolean).map((e=>e.split("</p>")[0].trim())),t=a.pop()||null,i=[];let n="",l=0;const c=window.innerWidth<=768,r=window.innerHeight,s=document.createElement("div");s.style.position="absolute",s.style.visibility="hidden",s.style.maxWidth="600px",s.style.fontFamily="graphr, sans-serif",s.style.fontSize="1.6rem",s.style.lineHeight="1.5",s.style.padding="10px",s.style.wordWrap="break-word";const o=document.createElement("style");o.textContent="\n    .blur {\n      filter: blur(4px);\n      display: inline-block;\n    }\n  ",document.head.appendChild(o),document.body.appendChild(s);try{const e=c&&r>400?600:800,o=c?500:1/0;if(a.length>0){const e=a.shift().trim();n=`<p>${e}</p>`,l=e.length}if(a.forEach((a=>{const t=a.trim(),c=`<p>${t}</p>`,r=t.length;s.innerHTML=re(n+c),s.scrollHeight>e||l+r>o?(i.push(n),n=c,l=r):(n+=c,l+=r)})),n&&i.push(n),t&&t.trim()){const a=`<blockquote>${t.trim()}</blockquote>`;s.innerHTML=re(n+a),s.scrollHeight>e?(i.push(n),i.push(a)):i[i.length-1]+=a}}finally{document.body.removeChild(s),document.head.removeChild(o)}return i},oe={};function de(e){const[a,t]=c.useState(null),[i,n]=c.useState(!0),[l,r]=c.useState(null),s=c.useRef(!0);return c.useEffect((()=>(s.current=!0,(async()=>{try{const a=await(async e=>{if(oe[e])return oe[e];try{const a=await fetch(e);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const t=await a.json();return oe[e]=t,t}catch(a){return null}})(e);if(!s.current)return;if(!a)throw new Error("Failed to load data");t(a),r(null)}catch(a){s.current&&r(a.message)}finally{s.current&&n(!1)}})(),()=>{s.current=!1})),[e]),{data:a,loading:i,error:l}}const me=e=>{if(!e)return"Не найден";const{name:a}=e;return["Фауст","Лонариус"].includes(a)?`${a}а`:a},he=({html:e,onHeightChange:a})=>{const t=c.useRef(null);if(c.useEffect((()=>{if(t.current&&a){const e=t.current.scrollHeight;a(e)}}),[e,a]),!e||"string"!=typeof e)return null;const i=document.createElement("div");i.innerHTML=e;const n=e=>{if(e.nodeType===Node.TEXT_NODE)return e.textContent;if(e.nodeType===Node.ELEMENT_NODE){const a=Array.from(e.childNodes).map(n),t={key:Math.random().toString(36).substr(2,9),className:e.className||void 0,style:e.style.cssText||void 0};return Array.from(e.attributes).forEach((e=>{"class"!==e.name&&"style"!==e.name&&(t[e.name]=e.value)})),p.createElement(e.tagName.toLowerCase(),t,...a)}return null};return s.jsx("div",{ref:t,className:"html-content",children:n(i)})},ue=({isOpen:e,onClose:a,id:t})=>{const[i,n]=c.useState(!1),[l,r]=c.useState(!1),[o,d]=c.useState(null),[m,h]=c.useState(0),u=c.useRef(null),{data:_,loading:p,error:v}=de("https://gist.githubusercontent.com/igorao79/17a1e2924e5dbee9371956c24be2a31b/raw/24a8ba7d250a00e594387072aa0fc47641c6b8a6/chlore.json"),{currentPage:f,nextPage:g,prevPage:k}=((e=0)=>{const[a,t]=c.useState(e);return{currentPage:a,nextPage:e=>{a<e-1&&t(a+1)},prevPage:()=>{a>0&&t(a-1)},setCurrentPage:t}})();c.useEffect((()=>(r(!0),d(document.body),()=>{r(!1),d(null)})),[]);const{character:b,pages:N}=c.useMemo((()=>{if(!_||!t)return{character:null,pages:[]};const e=((e,a)=>{const t=e[a];if(t&&t.lore&&"string"==typeof t.lore)return t})(_,t);return e&&e.lore&&""!==e.lore.trim()?{character:e,pages:se(e.lore)}:{character:e,pages:[]}}),[_,t]);return e&&b&&0!==N.length&&l&&o?p?y.createPortal(s.jsx("div",{className:ce.modalOverlay,children:s.jsx("div",{className:ce.loading,children:"Loading..."})}),o):v?y.createPortal(s.jsx("div",{className:ce.modalOverlay,children:s.jsxs("div",{className:ce.error,children:["Error: ",v]})}),o):y.createPortal(s.jsx("div",{className:ce.modalOverlay,children:s.jsxs("div",{className:ce.modalOverlay__content,onClick:e=>e.stopPropagation(),children:[s.jsx("button",{onClick:a,className:ce.modalOverlay__closeButton,children:s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 30 30",children:s.jsx("path",{d:"M7 4H6L4 6v2l8 7-8 7v2l2 2h2l7-8 7 8h2l2-2v-2l-8-7 8-7V6l-2-2h-2l-7 8-7-8H7z"})})}),s.jsxs("div",{className:ce.modalOverlay__textContent,children:[s.jsxs("div",{className:ce.modalOverlay__navigation,children:[s.jsx("button",{onClick:()=>{n(!0),setTimeout((()=>{k(),n(!1)}),300)},disabled:0===f,className:`${ce.modalOverlay__arrowLeft} ${0===f?ce.disabled:""}`,children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:s.jsx("path",{d:"m12.718 4.707-1.413-1.415L2.585 12l8.72 8.707 1.413-1.415L6.417 13H20v-2H6.416l6.302-6.293z"})})}),s.jsx("button",{onClick:()=>{n(!0),setTimeout((()=>{g(N.length),n(!1)}),300)},disabled:f===N.length-1,className:`${ce.modalOverlay__arrowRight} ${f===N.length-1?ce.disabled:""}`,children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:s.jsx("path",{d:"M11.293 4.707 17.586 11H4v2h13.586l-6.293 6.293 1.414 1.414L21.414 12l-8.707-8.707-1.414 1.414z"})})})]}),s.jsxs("h2",{className:ce.modalOverlay__title,children:["Лор ",me(b)]}),s.jsx("div",{className:ce.modalOverlay__textBlock,ref:u,children:s.jsx("div",{className:`${ce.modalOverlay__textBlock__textCont} ${i?ce.fadeOut:ce.fadeIn}`,children:s.jsx(he,{html:N[f],onHeightChange:e=>{h(e)}})})}),s.jsxs("div",{className:ce.modalOverlay__pageIndicator,children:["Страница ",f+1," из ",N.length]})]})]})}),o):null},_e=({id:e})=>{const[a,t]=c.useState(!1),[i,n]=c.useState(!1);c.useEffect((()=>(n(!0),()=>n(!1))),[]);const l=()=>{t(!1)},r=e=>{"Escape"===e.key&&l()};return c.useEffect((()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)})),[]),i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:ne.wrapper,children:s.jsxs("button",{className:ne.button,onClick:()=>{t(!0)},children:[s.jsx("span",{className:`${Y} _text-animation-slow_19xob_239`,children:s.jsx(le,{text:"Читать лор"})}),s.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",className:ne.icon,children:s.jsx("path",{clipRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm4.28 10.28a.75.75 0 000-1.06l-3-3a.75.75 0 10-1.06 1.06l1.72 1.72H8.25a.75.75 0 000 1.5h5.69l-1.72 1.72a.75.75 0 101.06 1.06l3-3z",fillRule:"evenodd"})})]})}),i&&a&&s.jsx(ue,{isOpen:a,onClose:l,id:e})]}):null};function pe({id:e,src:a,name:t,surname:i="",age:n="?",height:l,bd:c="?"}){return s.jsxs("div",{id:e,className:te.menu,children:[s.jsx("div",{className:te.menu__left,children:s.jsxs("picture",{className:te.menu__left__pic,children:[s.jsx("source",{srcSet:`./pics/char/picsfull/${a}.avif`,type:"image/avif"}),s.jsx("source",{srcSet:`./pics/char/picsfull/${a}.webp`,type:"image/webp"}),s.jsx("img",{src:`./pics/char/picsfull/${a}.png`,alt:`icon-${t}`,loading:"lazy"})]})}),s.jsxs("div",{className:te.menu__right,children:[s.jsxs("div",{className:te.menu__right__titleblock,children:[s.jsx("h2",{className:`${te.menu__right__titleblock__fullname} ${Y}`,children:s.jsx(le,{text:`${t} ${i}`})}),s.jsxs("div",{className:te.menu__right__titleblock__maininfo,children:[s.jsx("span",{className:`${te.menu__right__titleblock__maininfo__age} ${Y}`,children:s.jsx(le,{text:`Возраст: ${n} ${"?"!==n&&ie(n)}`})}),s.jsx("span",{className:`${te.menu__right__titleblock__maininfo__height} ${Y}`,children:s.jsx(le,{text:`Рост: ${l} см`})}),s.jsx("span",{className:`${te.menu__right__titleblock__maininfo__bd} ${Y}`,children:s.jsx(le,{text:`День рождения: ${c}`})})]})]}),s.jsx(_e,{id:e})]})]})}const ye=c.createContext(),ve={light:{"--primary-color":"#000000","--background-color":"#ffffff","--text-color":"#000000","--secondary-color":"#666666","--accent-color":"#3498db"},dark:{"--primary-color":"#ffffff","--background-color":"#1a1a1a","--text-color":"#ffffff","--secondary-color":"#999999","--accent-color":"#3498db"}},fe=({children:e})=>{const a=localStorage.getItem("theme")||"light",[t,i]=c.useState(a),n=c.useCallback((e=>{const a=ve[e];Object.entries(a).forEach((([e,a])=>{document.documentElement.style.setProperty(e,a)})),document.documentElement.setAttribute("data-theme",e)}),[]),l=c.useCallback((()=>{const e="light"===t?"dark":"light";i(e),n(e),localStorage.setItem("theme",e)}),[t,n]);c.useEffect((()=>{n(a)}),[n,a]);const r=c.useMemo((()=>({theme:t,toggleTheme:l})),[t,l]);return s.jsx(ye.Provider,{value:r,children:e})},ge=p.memo((({src:e,index:a,onClick:t})=>{const{theme:i}=c.useContext(ye),n=c.useMemo((()=>({avif:`./pics/icons/${e}.avif`,webp:`./pics/icons/${e}.webp`,png:`./pics/icons/${e}.png`})),[e]);return s.jsxs("div",{children:[s.jsx("hr",{}),s.jsx("button",{className:"_btn_2wi9v_2",onClick:t,children:s.jsxs("picture",{className:"_btn__pic_2wi9v_19 "+("dark"===i?"_darkTheme_2wi9v_30":""),children:[s.jsx("source",{srcSet:n.avif,type:"image/avif"}),s.jsx("source",{srcSet:n.webp,type:"image/webp"}),s.jsx("img",{src:n.png,alt:`icon-${a}`,loading:"eager",decoding:"async"})]})}),s.jsx("hr",{})]})}));ge.displayName="Icon";const ke=({icons:e,onIconClick:a})=>{const[t,i]=c.useState(0),n=e.slice(t,t+3);return s.jsx("div",{className:ee.window__panel,children:s.jsxs("div",{className:ee.window__panel__navButtons,children:[s.jsx("button",{className:`${ee.window__panel__navButtons__navButton} ${0===t?ee.disabled:""}`,onClick:()=>{i((e=>e>0?e-1:e))},disabled:0===t,"aria-label":"Назад",children:s.jsx("span",{className:ee.window__panel__navButtons__navButton__arrow,children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:s.jsx("path",{d:"m3.293 11.293 1.414 1.414L11 6.414V20h2V6.414l6.293 6.293 1.414-1.414L12 2.586l-8.707 8.707z"})})})}),s.jsx("div",{className:ee.window__panel__iconWrapper,children:s.jsx(u,{mode:"popLayout",children:n.map(((e,i)=>s.jsx(_.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},transition:{duration:.3,ease:"easeOut"},className:ee.window__panel__iconWrapper__icons,children:s.jsx(ge,{src:e,index:t+i,onClick:()=>a(e)})},t+i)))})}),s.jsx("button",{className:`${ee.window__panel__navButtons__navButton} ${t>=e.length-3?ee.disabled:""}`,onClick:()=>{i((a=>a<e.length-3?a+1:a))},disabled:t>=e.length-3,"aria-label":"Вперёд",children:s.jsx("span",{className:ee.window__panel__navButtons__navButton__arrow,children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:s.jsx("path",{d:"M13 17.586V4h-2v13.586l-6.293-6.293-1.414 1.414L12 21.414l8.707-8.707-1.414-1.414L13 17.586z"})})})})]})})},be=["faust","lonarius","vivian","akito"];function Ne(){var e,a,t,i,n,l,r;const[o,d]=c.useState(null),[m,h]=c.useState(1),[u,_]=c.useState(!1),{data:p}=de("https://gist.githubusercontent.com/igorao79/17a1e2924e5dbee9371956c24be2a31b/raw/24a8ba7d250a00e594387072aa0fc47641c6b8a6/chlore.json"),y=c.useCallback((e=>{u||(_(!0),h(o?be.indexOf(e)>be.indexOf(o)?1:-1:1),d(e),setTimeout((()=>_(!1)),300))}),[u,o]);return s.jsxs("div",{className:ee.window,children:[s.jsx(ke,{icons:be,onIconClick:y}),s.jsx(ae,{selectedIcon:o,direction:m,children:o&&p[o]&&s.jsx(pe,{id:o,src:null==(e=p[o])?void 0:e.src,name:null==(a=p[o])?void 0:a.name,surname:null==(t=p[o])?void 0:t.surname,age:null==(i=p[o])?void 0:i.age,height:null==(n=p[o])?void 0:n.height,bd:null==(l=p[o])?void 0:l.bd,lore:null==(r=p[o])?void 0:r.lore})})]})}const we="_aboutblock__header__textblock__text_16ydj_38",xe="_aboutblock__header__textblock__text__icon_16ydj_44",$e="_aboutblock__header__textblock__text__icon__main_16ydj_47",Ae="_aboutblock__header__textblock__text__icon__small_16ydj_51",Ce={member:"_member_1dq4u_2",member__imageWrapper:"_member__imageWrapper_1dq4u_21",member__image:"_member__image_1dq4u_21",member__info:"_member__info_1dq4u_35",member__info__details:"_member__info__details_1dq4u_44",member__info__details__name:"_member__info__details__name_1dq4u_49",member__info__details__role:"_member__info__details__role_1dq4u_75",member__info__bio:"_member__info__bio_1dq4u_81","member--igor":"_member--igor_1dq4u_85",rotate:"_rotate_1dq4u_1","member--lesya":"_member--lesya_1dq4u_95",float:"_float_1dq4u_1",borderRotate:"_borderRotate_1dq4u_1",blink:"_blink_1dq4u_1"},Be={igor:{src:"igorpic",id:"igor",name:"Игорь",bookteam:"Автор",developerteam:"Главный разработчик",bio:"d"},lesya:{src:"lesyapic",id:"lesya",name:"Леся",bookteam:"Художник, Соавтор",bio:"o"}},Se=p.memo((({memberId:e})=>{const{theme:a}=c.useContext(ye),t=c.useMemo((()=>Be[e]),[e]);if(!t)return s.jsx("div",{className:Ce.member__notfound,children:"Участник не найден."});const{imageSrc:i,safeId:n}=c.useMemo((()=>({imageSrc:`./pics/team/${t.src}`,safeId:`member--${t.id.replace(/\s+/g,"-").toLowerCase()}`})),[t]);return i?s.jsxs("div",{className:`${Ce.member} ${Ce[`member--${t.id}`]}`,id:n,children:[s.jsx("div",{className:Ce.member__imageWrapper,children:s.jsxs("picture",{className:`${Ce.member__imageContainer} ${"dark"===a?Ce.darkTheme:""}`,children:[s.jsx("source",{srcSet:`${i}.avif`,type:"image/avif"}),s.jsx("source",{srcSet:`${i}.webp`,type:"image/webp"}),s.jsx("img",{src:`${i}.png`,alt:t.name,className:Ce.member__image,loading:"lazy",decoding:"async"})]})}),s.jsxs("div",{className:Ce.member__info,children:[s.jsxs("div",{className:Ce.member__info__details,children:[s.jsx("h3",{className:Ce.member__info__details__name,children:t.name}),s.jsx("p",{className:Ce.member__info__details__role,children:t.bookteam})]}),s.jsx("p",{className:Ce.member__info__bio,children:t.bio})]})]}):s.jsx("div",{className:Ce.member__notfound,children:"Изображение не найдено."})}));Se.displayName="BookMember";const De=()=>s.jsxs("a",{href:"https://t.me/+yFsUa_nD88piNjg6",target:"_blank",rel:"noopener noreferrer",className:"_button_13ed2_1",children:[s.jsx("div",{className:"_icon_13ed2_41",children:s.jsx("svg",{width:16,height:16,className:"bi bi-telegram",viewBox:"0 0 16 16",fill:"currentColor",children:s.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.3 6A388.8 388.8 0 0 0 3 8.3c0 .2.3.3.7.4H4l1.2.4.9-.3a82.9 82.9 0 0 1 3.6-2.1l-2 1.9-.3.3a8.2 8.2 0 0 1-.2.2c-.4.4-.7.7 0 1.1A66.2 66.2 0 0 1 9 11.4l.3.2c.3.2.6.4 1 .4.2 0 .4-.2.5-.8l1-5.8a1.4 1.4 0 0 0-.1-.3.3.3 0 0 0-.1-.2.5.5 0 0 0-.3 0c-.3 0-.8 0-3 1z"})})}),"Telegram"]}),Ee=p.memo((({memberId:e})=>{const{theme:a}=c.useContext(ye),t=c.useMemo((()=>Be[e]),[e]);if(!t)return s.jsx("div",{className:Ce.member__notfound,children:"Участник не найден."});const{imageSrc:i,safeId:n}=c.useMemo((()=>({imageSrc:`./pics/team/${t.src}`,safeId:`member--${t.id.replace(/\s+/g,"-").toLowerCase()}`})),[t]);return i?s.jsxs("div",{className:`${Ce.member} ${Ce[`member--${t.id}`]}`,id:n,children:[s.jsx("div",{className:Ce.member__imageWrapper,children:s.jsxs("picture",{className:`${Ce.member__imageContainer} ${"dark"===a?Ce.darkTheme:""}`,children:[s.jsx("source",{srcSet:`${i}.avif`,type:"image/avif"}),s.jsx("source",{srcSet:`${i}.webp`,type:"image/webp"}),s.jsx("img",{src:`${i}.png`,alt:t.name,className:Ce.member__image,loading:"lazy",decoding:"async"})]})}),s.jsx("div",{className:Ce.member__info,children:s.jsxs("div",{className:Ce.member__info__details,children:[s.jsx("h3",{className:Ce.member__info__details__name,children:t.name}),s.jsx("p",{className:Ce.member__info__details__role,children:t.developerteam})]})})]}):s.jsx("div",{className:Ce.member__notfound,children:"Изображение не найдено."})}));function Ie(){return s.jsxs("div",{className:"_aboutblock_16ydj_2",children:[s.jsxs("header",{className:"_aboutblock__header_16ydj_15",children:[s.jsx("h2",{className:"_aboutblock__header__htitle_16ydj_22",children:"О нашей книге"}),s.jsxs("div",{className:"_aboutblock__header__textblock_16ydj_27",children:[s.jsxs("div",{className:we,children:[s.jsxs("svg",{className:xe,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 122.9 108.7",width:"50",height:"50",children:[s.jsx("path",{className:$e,d:"M95.2 91.4h-.8a1.6 1.6 0 0 1-1.6-1.7 23 23 0 0 0-1.9-9 27 27 0 0 0-13.4-13.5 23 23 0 0 0-9.1-1.8 1.6 1.6 0 0 1-1.6-1.7V63a1.6 1.6 0 0 1 1.6-1.7 22.9 22.9 0 0 0 9.1-1.8 25.4 25.4 0 0 0 8-5.5 25.6 25.6 0 0 0 5.4-7.9 22.9 22.9 0 0 0 1.8-9.1 1.6 1.6 0 0 1 1.7-1.6h.8a1.6 1.6 0 0 1 1.7 1.6 22.9 22.9 0 0 0 1.8 9.1 25.2 25.2 0 0 0 5.5 8 25.2 25.2 0 0 0 8 5.4 22.9 22.9 0 0 0 9 1.8A1.6 1.6 0 0 1 123 63v.8a1.6 1.6 0 0 1-1.7 1.7 23 23 0 0 0-9 1.8 27 27 0 0 0-13.5 13.4 23 23 0 0 0-1.8 9.1 1.6 1.6 0 0 1-1.7 1.7Z"}),s.jsx("path",{className:Ae,d:"M62 50h-.3a.4.4 0 0 1-.4-.4 6 6 0 0 0-.5-2.4 7.2 7.2 0 0 0-1.7-2.2 7.2 7.2 0 0 0-2.2-1.8 6 6 0 0 0-2.4-.4.4.4 0 0 1-.4-.4V42a.4.4 0 0 1 .4-.4 6 6 0 0 0 2.4-.5 7.2 7.2 0 0 0 2.2-1.7 7.2 7.2 0 0 0 1.7-2.2 6 6 0 0 0 .5-2.4.4.4 0 0 1 .4-.4h.3a.4.4 0 0 1 .4.4 6 6 0 0 0 .5 2.4 7.2 7.2 0 0 0 1.7 2.2 7.2 7.2 0 0 0 2.2 1.7 6 6 0 0 0 2.4.5.4.4 0 0 1 .4.4v.3a.4.4 0 0 1-.4.4 6 6 0 0 0-2.4.5 7.2 7.2 0 0 0-2.2 1.7 7.2 7.2 0 0 0-1.7 2.2 6 6 0 0 0-.5 2.4.4.4 0 0 1-.4.4Z"})]}),s.jsx("p",{children:"Основной жанр нашей книги - фэнтэзи с элементами дарк фэнтэзи, романтики и приключений"})]}),s.jsxs("div",{className:we,children:[s.jsxs("svg",{className:xe,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 122.88 108.69",width:"50",height:"50",children:[s.jsx("path",{className:$e,d:"M95.24,91.38H94.4a1.65,1.65,0,0,1-1.65-1.65,22.91,22.91,0,0,0-1.81-9.12A27.06,27.06,0,0,0,77.52,67.19a23.05,23.05,0,0,0-9.12-1.81,1.65,1.65,0,0,1-1.64-1.64v-.85a1.64,1.64,0,0,1,1.64-1.64,22.88,22.88,0,0,0,9.12-1.82,25.35,25.35,0,0,0,7.93-5.49A25.62,25.62,0,0,0,90.94,46a22.87,22.87,0,0,0,1.81-9.11,1.65,1.65,0,0,1,1.65-1.64h.84a1.65,1.65,0,0,1,1.65,1.64A22.88,22.88,0,0,0,98.7,46a25.24,25.24,0,0,0,5.49,7.93,25.19,25.19,0,0,0,7.93,5.49,22.88,22.88,0,0,0,9.12,1.82,1.64,1.64,0,0,1,1.64,1.64v.85a1.65,1.65,0,0,1-1.64,1.64,23.05,23.05,0,0,0-9.12,1.81A27.06,27.06,0,0,0,98.7,80.61a23,23,0,0,0-1.81,9.12,1.65,1.65,0,0,1-1.65,1.65Z"}),s.jsx("path",{className:Ae,d:"M65,55h-0.7a1,1,0,0,1-1-1,15,15,0,0,0-1.2-6,18,18,0,0,0-4.3-5.6,18,18,0,0,0-5.6-4.3,15,15,0,0,0-6-1.2,1,1,0,0,1-1-1V35a1,1,0,0,1,1-1,15,15,0,0,0,6-1.2,18,18,0,0,0,5.6-4.3,18,18,0,0,0,4.3-5.6,15,15,0,0,0,1.2-6,1,1,0,0,1,1-1H65a1,1,0,0,1,1,1,15,15,0,0,0,1.2,6,18,18,0,0,0,4.3,5.6,18,18,0,0,0,5.6,4.3,15,15,0,0,0,6,1.2,1,1,0,0,1,1,1v0.7a1,1,0,0,1-1,1,15,15,0,0,0-6,1.2,18,18,0,0,0-5.6,4.3,18,18,0,0,0-4.3,5.6,15,15,0,0,0-1.2,6,1,1,0,0,1-1,1Z",fill:"black",transform:"scale(0.4) translate(90,70)"})]}),s.jsxs("p",{children:["Книга была создана 27 июня 2024 года — совершенно спонтанно, без чётких целей. За её развитием вы можете следить ",s.jsx("a",{href:"https://t.me/+yFsUa_nD88piNjg6",children:"здесь"})]})]}),s.jsxs("div",{className:we,children:[s.jsxs("svg",{className:xe,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 122.88 108.69",width:"50",height:"50",children:[s.jsx("path",{className:$e,d:"M95.24,91.38H94.4a1.65,1.65,0,0,1-1.65-1.65,22.91,22.91,0,0,0-1.81-9.12A27.06,27.06,0,0,0,77.52,67.19a23.05,23.05,0,0,0-9.12-1.81,1.65,1.65,0,0,1-1.64-1.64v-.85a1.64,1.64,0,0,1,1.64-1.64,22.88,22.88,0,0,0,9.12-1.82,25.35,25.35,0,0,0,7.93-5.49A25.62,25.62,0,0,0,90.94,46a22.87,22.87,0,0,0,1.81-9.11,1.65,1.65,0,0,1,1.65-1.64h.84a1.65,1.65,0,0,1,1.65,1.64A22.88,22.88,0,0,0,98.7,46a25.24,25.24,0,0,0,5.49,7.93,25.19,25.19,0,0,0,7.93,5.49,22.88,22.88,0,0,0,9.12,1.82,1.64,1.64,0,0,1,1.64,1.64v.85a1.65,1.65,0,0,1-1.64,1.64,23.05,23.05,0,0,0-9.12,1.81A27.06,27.06,0,0,0,98.7,80.61a23,23,0,0,0-1.81,9.12,1.65,1.65,0,0,1-1.65,1.65Z"}),s.jsx("path",{className:Ae,d:"M65,55h-0.7a1,1,0,0,1-1-1,15,15,0,0,0-1.2-6,18,18,0,0,0-4.3-5.6,18,18,0,0,0-5.6-4.3,15,15,0,0,0-6-1.2,1,1,0,0,1-1-1V35a1,1,0,0,1,1-1,15,15,0,0,0,6-1.2,18,18,0,0,0,5.6-4.3,18,18,0,0,0,4.3-5.6,15,15,0,0,0,1.2-6,1,1,0,0,1,1-1H65a1,1,0,0,1,1,1,15,15,0,0,0,1.2,6,18,18,0,0,0,4.3,5.6,18,18,0,0,0,5.6,4.3,15,15,0,0,0,6,1.2,1,1,0,0,1,1,1v0.7a1,1,0,0,1-1,1,15,15,0,0,0-6,1.2,18,18,0,0,0-5.6,4.3,18,18,0,0,0-4.3,5.6,15,15,0,0,0-1.2,6,1,1,0,0,1-1,1Z",fill:"black",transform:"scale(0.4) translate(90,70)"})]}),s.jsx("p",{children:"adsada"})]}),s.jsx("div",{className:we,children:s.jsx(De,{})})]})]}),s.jsxs("div",{className:"_aboutblock__main_16ydj_55",children:[s.jsx("h2",{className:"_aboutblock__main__btitle_16ydj_63",children:"Творческая команда"}),s.jsxs("div",{className:"_aboutblock__main__authors_16ydj_68",children:[s.jsx(Se,{memberId:"igor"}),s.jsx(Se,{memberId:"lesya"})]}),s.jsx("h2",{className:"_aboutblock__main__dtitle_16ydj_63",children:"Команда разработки"}),s.jsx("div",{className:"_aboutblock__main__developers_16ydj_68",children:s.jsx(Ee,{memberId:"igor"})})]})]})}Ee.displayName="DeveloperMember";const Oe="_main__nav__perexod__link_ptfdc_52",Pe=({src:e,alt:a})=>{const{theme:t}=c.useContext(ye),i=e.replace("-black","");return s.jsxs("picture",{className:"_main__header__pic_ptfdc_21 "+("dark"===t?"_darkTheme_ptfdc_35":""),children:[s.jsx("source",{srcSet:`${i}.avif`,type:"image/avif"}),s.jsx("source",{srcSet:`${i}.webp`,type:"image/webp"}),s.jsx("img",{src:`${i}.png`,alt:a,loading:"lazy"})]})},Te="https://scapi-dj82ynavq-igors-projects-f86e1b8f.vercel.app",Fe=e=>`https://corsproxy.io/?${encodeURIComponent(e)}`,Ge=async(e,a={})=>{try{const t={"Content-Type":"application/json",Authorization:`Bearer ${await(async()=>{const e=Z.currentUser;if(!e)throw new Error("Пользователь не авторизован");try{return await e.getIdToken(!0)}catch(la){throw la}})()}`,...a.headers},i=Fe(`${Te}${e}`),n=await fetch(i,{...a,headers:t});if(!n.ok){const e=await n.text();throw new Error(`Ошибка API: ${n.status} ${e}`)}return 204===n.status?null:await n.json()}catch(la){throw la}},Ve=async(e,a={})=>{try{let i={"Content-Type":"application/json",...a.headers};if(Z.currentUser)try{const e=await Z.currentUser.getIdToken(!0);i.Authorization=`Bearer ${e}`}catch(t){}const n=Fe(`${Te}${e}`),l=await fetch(n,{...a,headers:i});if(!l.ok){const t=await l.text();if(401===l.status&&(e.startsWith("/api/posts")||e.includes("/search")))return(async(e,a={})=>{try{const t={"Content-Type":"application/json",...a.headers},i=Fe(`${Te}${e}`),n=await fetch(i,{...a,headers:t});if(!n.ok){const e=await n.text();throw new Error(`Ошибка API: ${n.status} ${e}`)}return 204===n.status?null:await n.json()}catch(la){throw la}})(e,a);throw new Error(`Ошибка API: ${l.status} ${t}`)}return 204===l.status?null:await l.json()}catch(la){throw la}},je=e=>Ve(`/api/users/${e}`),qe=e=>Ve(`/api/posts/${e}/poll/results`),Me=e=>{const[a,t]=c.useState(!1),[i,n]=c.useState(!0);return c.useEffect((()=>{if(!e)return t(!1),void n(!1);(async()=>{try{n(!0);const a=await je(e);t(!0===(null==a?void 0:a.isAdmin))}catch(la){t(!1)}finally{n(!1)}})()}),[e]),{isAdmin:a,loading:i}},Le=()=>{const{currentUser:e}=c.useContext(Q),{isAdmin:a}=Me(null==e?void 0:e.uid),[t,i]=c.useState(""),[n,l]=c.useState(""),[r,o]=c.useState(!1),[d,m]=c.useState(["",""]),[h,u]=c.useState("#000000"),[_,p]=c.useState("#000000"),[y,A]=c.useState("Arial"),[C,B]=c.useState(""),[S,D]=c.useState(""),[E,I]=c.useState(!1),[O,P]=c.useState(!1);return c.useEffect((()=>{if(S){const e=setTimeout((()=>{D("")}),3e3);return()=>clearTimeout(e)}}),[S]),a?s.jsxs("div",{className:"create-post "+(O?"collapsed":""),children:[s.jsxs("button",{type:"button",className:"create-post-toggle",onClick:()=>{P(!O)},children:[O?s.jsx(v,{}):s.jsx(f,{}),O?"Показать панель создания постов":"Скрыть панель создания постов"]}),!O&&s.jsxs(s.Fragment,{children:[C&&s.jsx("div",{className:"error",children:C}),S&&s.jsx("div",{className:"success",children:S}),s.jsxs("form",{onSubmit:async a=>{a.preventDefault(),B(""),D(""),I(!0);try{if(!t.trim())throw new Error("Пожалуйста, введите заголовок");if(!r&&!n.trim())throw new Error("Пожалуйста, введите содержание поста");if(r){const e=d.filter((e=>""!==e.trim()));if(e.length<2)throw new Error("Добавьте как минимум два варианта ответа");if(new Set(e).size!==e.length)throw new Error("Варианты ответа не должны повторяться")}const a={title:t,content:r?"":n,authorId:e.uid,authorName:e.displayName,authorPhotoURL:e.photoURL,createdAt:w(),likesCount:0,commentsCount:0,style:{titleColor:h,textColor:_,fontFamily:y},isPoll:r,poll:r?{options:d.filter((e=>""!==e.trim())),votes:{},results:{}}:null};await x($(K,"posts"),a),i(""),l(""),o(!1),m(["",""]),u("#000000"),p("#000000"),A("Arial"),D("Пост успешно создан!")}catch(c){B(c.message)}finally{I(!1)}},children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"title",children:"Заголовок"}),s.jsx("input",{type:"text",id:"title",value:t,onChange:e=>i(e.target.value),placeholder:"Введите заголовок поста",required:!0})]}),!r&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"content",children:"Содержание поста"}),s.jsx("textarea",{id:"content",value:n,onChange:e=>l(e.target.value),placeholder:"Введите содержание поста...",required:!0})]}),s.jsx("div",{className:"poll-toggle",children:s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:r,onChange:e=>{o(e.target.checked),e.target.checked&&l("")}}),s.jsx(g,{className:"poll-icon"})," Создать как опрос"]})}),r&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Варианты ответа"}),d.map(((e,a)=>s.jsxs("div",{className:"poll-option-input",children:[s.jsx("input",{type:"text",value:e,onChange:e=>((e,a)=>{const t=[...d];t[e]=a,m(t)})(a,e.target.value),placeholder:`Вариант ${a+1}`,required:!0}),d.length>2&&s.jsx("button",{type:"button",onClick:()=>(e=>{if(d.length<=2)return;const a=d.filter(((a,t)=>t!==e));m(a)})(a),className:"remove-option",title:"Удалить вариант",children:s.jsx(k,{})})]},a))),s.jsxs("button",{type:"button",className:"add-option",onClick:()=>{d.some((e=>""===e.trim()))?B("Пожалуйста, заполните все существующие варианты ответа"):m([...d,""])},children:[s.jsx(g,{})," Добавить вариант"]})]}),s.jsxs("div",{className:"style-options",children:[s.jsxs("div",{className:"color-picker-container",children:[s.jsxs("label",{className:"color-picker-label",children:[s.jsx(b,{})," Цвет заголовка"]}),s.jsx("input",{type:"color",value:h,onChange:e=>u(e.target.value),className:"color-picker"})]}),s.jsxs("div",{className:"color-picker-container",children:[s.jsxs("label",{className:"color-picker-label",children:[s.jsx(b,{})," Цвет текста"]}),s.jsx("input",{type:"color",value:_,onChange:e=>p(e.target.value),className:"color-picker"})]}),s.jsxs("div",{className:"font-selector",children:[s.jsxs("label",{children:[s.jsx(N,{})," Шрифт"]}),s.jsx("select",{value:y,onChange:e=>A(e.target.value),children:["Arial","Helvetica","Times New Roman","Georgia","Verdana","Roboto","Open Sans","Lato","Montserrat","Source Sans Pro","Oswald","Raleway","Ubuntu","Playfair Display","Merriweather","PT Sans","PT Serif","Noto Sans","Noto Serif"].map((e=>s.jsx("option",{value:e,style:{fontFamily:e},children:e},e)))})]})]}),s.jsxs("div",{className:"preview-section",children:[s.jsx("h3",{children:"Предварительный просмотр"}),s.jsxs("div",{className:"post-preview",style:{fontFamily:y},children:[s.jsx("h2",{className:"post-title",style:{color:h},children:t||"Заголовок поста"}),!r&&s.jsx("div",{className:"post-content",style:{color:_},children:n||"Содержание поста"}),r&&s.jsxs("div",{className:"poll-preview",children:[s.jsx("div",{className:"poll-options",children:d.map(((e,a)=>s.jsx("div",{className:"poll-option",style:{color:_,fontFamily:y},children:s.jsxs("div",{className:"poll-option-content",children:[s.jsx("div",{className:"poll-option-text",children:e||`Вариант ${a+1}`}),s.jsxs("div",{className:"poll-option-result",children:[s.jsx("div",{className:"poll-option-bar",style:{width:"0%"}}),s.jsxs("div",{className:"poll-option-stats",children:[s.jsx("span",{children:"0 голосов"}),s.jsx("span",{children:"0%"})]})]})]})},a)))}),s.jsx("div",{className:"poll-total",children:"Всего голосов: 0"})]})]})]}),s.jsx("button",{type:"submit",className:"submit-button",disabled:E,children:E?"Создание...":"Создать пост"})]})]})]}):null},He=({postId:e,currentUserId:a,isAdmin:t,onCommentCountChange:i})=>{const[n,l]=c.useState([]),[r,o]=c.useState(!0),[d,m]=c.useState(""),[h,u]=c.useState(null),[_,p]=c.useState(""),[y,v]=c.useState({}),[f,g]=c.useState(0),k=c.useCallback((e=>e?new Date(e).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):""),[]),b=c.useCallback((e=>e?e.isAdmin?"comment-author admin":e.isEarlyUser?"comment-author early-user":e.customTitle?"comment-author custom-title":"comment-author":"comment-author"),[]),N=c.useCallback((e=>e?e.isAdmin?s.jsx(C,{className:"privilege-icon"}):e.isEarlyUser?s.jsx(B,{className:"privilege-icon"}):e.customTitle?s.jsx(S,{className:"privilege-icon"}):s.jsx(A,{className:"privilege-icon"}):s.jsx(A,{className:"privilege-icon"})),[]),w=c.useCallback((async e=>{if(!e)return{};if(y[e])return y[e];try{const a=await je(e);return v((t=>({...t,[e]:a}))),a}catch(a){return{}}}),[y]);c.useEffect((()=>{e?(o(!0),m(""),(async()=>{try{const a=await((e,a={})=>{const{limit:t,offset:i,orderBy:n}=a;let l=`/api/posts/${e}/comments?`;return t&&(l+=`limit=${t}&`),i&&(l+=`offset=${i}&`),n&&(l+=`orderBy=${n}&`),Ve(l)})(e,{orderBy:"createdAt:desc"}),t=[];for(const e of a){const a=await w(e.authorId);t.push({...e,createdAt:e.createdAt?new Date(e.createdAt):new Date,userData:{isAdmin:a.isAdmin||!1,isEarlyUser:a.isEarlyUser||!1,customTitle:a.customTitle||null}})}l(t),i&&i(t.length),m(""),g(0)}catch(a){f<3?(g((e=>e+1)),m(`Ошибка при загрузке комментариев. Попытка ${f+1} из 3...`)):m("Не удалось загрузить комментарии. Пожалуйста, обновите страницу.")}finally{o(!1)}})()):o(!1)}),[e,w,i,f]);const x=c.useCallback((async c=>{var r;if(a&&(t||(null==(r=n.find((e=>e.id===c)))?void 0:r.authorId)===a))try{await((e,a)=>Ge(`/api/posts/${e}/comments/${a}`,{method:"DELETE"}))(e,c),l((e=>e.filter((e=>e.id!==c)))),i&&i(n.length-1)}catch(s){}}),[n,a,t,i,e]),$=c.useCallback((e=>{u(e.id),p(e.content)}),[]),I=c.useCallback((()=>{u(null),p("")}),[]),O=c.useCallback((async a=>{if(_.trim())try{await((e,a,t)=>Ge(`/api/posts/${e}/comments/${a}`,{method:"PUT",body:JSON.stringify({content:t})}))(e,a,_),l((e=>e.map((e=>e.id===a?{...e,content:_}:e)))),u(null),p("")}catch(t){}}),[_,e]);return r?s.jsx("div",{className:"loading-comments",children:"Загрузка комментариев..."}):d?s.jsx("div",{className:"error-message",children:d}):0===n.length?s.jsx("div",{className:"no-comments",children:"Пока нет комментариев. Будьте первым!"}):s.jsx("div",{className:"comment-list",children:n.map((e=>s.jsxs("div",{className:"comment",children:[s.jsxs("div",{className:"comment-header",children:[s.jsxs("div",{className:b(e.userData),children:[N(e.userData),s.jsx("span",{children:e.authorName})]}),s.jsx("div",{className:"comment-date",children:k(e.createdAt)})]}),h===e.id?s.jsxs("div",{className:"edit-comment",children:[s.jsx("textarea",{value:_,onChange:e=>p(e.target.value),className:"edit-comment-input"}),s.jsxs("div",{className:"edit-actions",children:[s.jsx("button",{onClick:()=>O(e.id),disabled:!_.trim(),className:"save-btn",children:"Сохранить"}),s.jsx("button",{onClick:I,className:"cancel-btn",children:"Отмена"})]})]}):s.jsx("div",{className:"comment-content",children:e.content}),(t||a===e.authorId)&&h!==e.id&&s.jsxs("div",{className:"comment-actions",children:[a===e.authorId&&s.jsxs("button",{onClick:()=>$(e),className:"edit-btn",children:[s.jsx(D,{})," Редактировать"]}),s.jsxs("button",{onClick:()=>x(e.id),className:"delete-btn",children:[s.jsx(E,{})," Удалить"]})]})]},e.id)))})},Ue=({postId:e})=>{const[a,t]=c.useState(""),[i,n]=c.useState(""),[l,r]=c.useState(!1),o=c.useCallback((async i=>{if(i.preventDefault(),Z.currentUser)if(a.trim()){r(!0),n("");try{await((e,a)=>Ge(`/api/posts/${e}/comments`,{method:"POST",body:JSON.stringify({content:a})}))(e,a.trim()),t("")}catch(l){n("Ошибка при создании комментария")}finally{r(!1)}}else n("Комментарий не может быть пустым");else n("Вы должны быть авторизованы, чтобы оставить комментарий")}),[a,e]),d=c.useCallback((e=>{t(e.target.value),i&&n("")}),[i]);return s.jsx("div",{className:"create-comment",children:s.jsxs("form",{onSubmit:o,children:[s.jsx("textarea",{placeholder:"Оставьте ваш комментарий...",value:a,onChange:d,disabled:l}),i&&s.jsx("div",{className:"error-message",children:i}),s.jsx("button",{type:"submit",disabled:l,className:l?"submitting":"",children:l?"Отправка...":"Отправить"})]})})},ze=({poll:e,postId:a,currentUser:t,style:i})=>{const[n,l]=c.useState(!1),[r,o]=c.useState(null),[d,m]=c.useState(e.results||{});c.useEffect((()=>{(async()=>{if(t)try{const e=await(e=>Ge(`/api/posts/${e}/poll/my-vote`))(a);e&&e.optionId&&(l(!0),o(e.optionId))}catch(la){}})(),(async()=>{try{const e=await qe(a);m(e)}catch(la){}})()}),[t,a,e]);const h=Object.values(d).reduce(((e,a)=>e+a),0);return s.jsxs("div",{className:"poll",style:{fontFamily:null==i?void 0:i.fontFamily},children:[s.jsx("div",{className:"poll-options",children:e.options.map(((e,c)=>{const u=d[e]||0,_=h>0?u/h*100:0,p=r===e;return s.jsx("div",{className:`poll-option ${n?"voted":""} ${p?"selected":""}`,onClick:()=>!n&&(async e=>{if(t&&!n)try{await((e,a)=>Ge(`/api/posts/${e}/poll/vote`,{method:"POST",body:JSON.stringify({optionId:a})}))(a,e),l(!0),o(e);const t=await qe(a);m(t)}catch(la){}})(e),style:{color:null==i?void 0:i.textColor},children:s.jsxs("div",{className:"poll-option-content",children:[s.jsxs("div",{className:"poll-option-text",children:[e,p&&s.jsx("span",{className:"selected-check",children:"✓"})]}),n&&s.jsxs("div",{className:"poll-option-result",children:[s.jsx("div",{className:"poll-option-bar",style:{width:`${_}%`}}),s.jsxs("div",{className:"poll-option-stats",children:[s.jsxs("span",{children:[u," голосов"]}),s.jsxs("span",{children:[_.toFixed(1),"%"]})]})]})]})},c)}))}),s.jsxs("div",{className:"poll-total",children:["Всего голосов: ",h]})]})},Re=({post:e,onDelete:a})=>{var t;const[i,n]=c.useState(!1),[l,r]=c.useState(!1),[o,d]=c.useState(e.likesCount||0),[m,h]=c.useState(e.commentsCount||0),[u,_]=c.useState(!1),[p,y]=c.useState(!0),[v,f]=c.useState(null),[g,k]=c.useState(null),[b,N]=c.useState(!1),[w,x]=c.useState(!1),[$,D]=c.useState(null),[T,F]=c.useState(!1),[G,V]=c.useState((null==(t=e.poll)?void 0:t.results)||{}),[j,q]=c.useState(e.likes||[]),[M,L]=c.useState([]),{userData:H}=(e=>{const[a,t]=c.useState(null),[i,n]=c.useState(!0),[l,r]=c.useState(null);return c.useEffect((()=>{if(!e)return t(null),void n(!1);n(!0);const a=new AbortController;return(async()=>{try{const a=await je(e);t(a),r(null)}catch(a){"AbortError"!==a.name&&(r(a.message),t(null))}finally{n(!1)}})(),()=>a.abort()}),[e]),{userData:a,loading:i,error:l}})(g),U=(null==H?void 0:H.isAdmin)||!1,z=e.style||{},R=z.titleColor||"#000000",W=z.textColor||"#000000",J=z.fontFamily||"Arial";c.useEffect((()=>{(async()=>{if(e.authorId)try{const a=await je(e.authorId);f(a)}catch(a){}})(),y(!1)}),[e.authorId]),c.useEffect((()=>{const e=Z.onAuthStateChanged((e=>{k((null==e?void 0:e.uid)||null)}));return()=>e()}),[]),c.useEffect((()=>{g?(async()=>{try{const e=await je(g);N(!0===(null==e?void 0:e.isAdmin))}catch(la){N(!1)}})():N(!1)}),[g]),c.useEffect((()=>{const a=async()=>{if(e.id)try{const t=await(a=e.id,Ve(`/api/posts/${a}`));t&&(h(t.commentsCount||0),d(t.likesCount||0))}catch(la){}var a};a();const t=setInterval(a,3e4);return()=>clearInterval(t)}),[e.id]),c.useEffect((()=>{g&&e.id&&(async()=>{try{const t=await(a=e.id,Ge(`/api/posts/${a}/liked`));n(!0===t.liked)}catch(la){}var a})()}),[g,e.id]);const K=c.useCallback((async()=>{if(g&&!w){x(!0);try{i?(await(a=e.id,Ge(`/api/posts/${a}/like`,{method:"DELETE"})),n(!1),d((e=>Math.max(0,e-1)))):(await(e=>Ge(`/api/posts/${e}/like`,{method:"POST"}))(e.id),n(!0),d((e=>e+1)))}catch(la){}finally{x(!1)}}var a}),[g,i,w,e.id]),Q=c.useCallback((async()=>{if(g&&(b||e.authorId===g)&&window.confirm("Вы уверены, что хотите удалить этот пост?")){_(!0);try{await(t=e.id,Ge(`/api/posts/${t}`,{method:"DELETE"})),a&&a(e.id)}catch(la){alert("Не удалось удалить пост. Пожалуйста, попробуйте позже.")}finally{_(!1)}}var t}),[g,b,a,e.authorId,e.id]),X=c.useCallback((()=>v?v.isAdmin?"author admin":v.isEarlyUser?"author early-user":v.customTitle?"author custom-title":"author":"author"),[v]),Y=c.useCallback((()=>v?v.isAdmin?s.jsx(C,{className:"privilege-icon",style:{color:"#FFD700"}}):v.isEarlyUser?s.jsx(B,{className:"privilege-icon",style:{color:"#FF4444"}}):v.customTitle?s.jsx(S,{className:"privilege-icon",style:{color:"#4A90E2"}}):s.jsx(A,{className:"privilege-icon",style:{color:"#2c3e50"}}):s.jsx(A,{className:"privilege-icon",style:{color:"#2c3e50"}})),[v]),ee=c.useCallback((e=>{h(e)}),[]),ae=c.useCallback((e=>{if(!e)return"";const a=new Date,t=new Date(e),i=Math.floor((a-t)/1e3);if(i<60)return"только что";if(i<3600){const e=Math.floor(i/60);return`${e} ${te(e)} назад`}if(i<86400){const e=Math.floor(i/3600);return`${e} ${ie(e)} назад`}return t.toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}),[]),te=e=>1===e?"минуту":e>=2&&e<=4?"минуты":"минут",ie=e=>1===e?"час":e>=2&&e<=4?"часа":"часов";c.useCallback((e=>{}),[]),c.useCallback((()=>{r(!0)}),[]);const ne=c.useMemo((()=>s.jsx(He,{postId:e.id,currentUserId:g,isAdmin:U,onCommentCountChange:ee})),[e.id,g,U,ee]),le=c.useMemo((()=>s.jsx(Ue,{postId:e.id})),[e.id]),ce=c.useMemo((()=>s.jsxs("div",{className:"comments-section",children:[le,ne]})),[le,ne]);return p?s.jsx("div",{className:"loading",children:"Загрузка..."}):s.jsxs("div",{className:"post",style:{fontFamily:J},children:[s.jsxs("div",{className:"post-header",children:[s.jsx("h2",{className:"post-title",style:{color:R,fontFamily:J},children:e.title}),b&&s.jsx("button",{className:"delete-button",onClick:Q,children:s.jsx(E,{})})]}),s.jsx("div",{className:"post-content",style:{color:W,fontFamily:J},children:e.content}),e.imageUrl&&s.jsx("div",{className:"post-image",children:s.jsx("img",{src:e.imageUrl,alt:"Post image"})}),e.isPoll&&s.jsx(ze,{poll:e.poll,postId:e.id,currentUser:Z.currentUser,style:{textColor:W,fontFamily:J}}),s.jsx("div",{className:"post-meta",children:s.jsxs("div",{className:"author-info",children:[s.jsxs("span",{className:`author ${X()}`,children:[Y(),e.authorName]}),s.jsx("span",{className:"post-date",children:ae(e.createdAt)})]})}),s.jsx("div",{className:"post-footer",children:s.jsxs("div",{className:"post-info",children:[s.jsxs("button",{className:"like-button "+(i?"liked":""),onClick:K,children:[i?s.jsx(I,{}):s.jsx(O,{}),s.jsx("span",{className:"like-count",children:o})]}),s.jsxs("button",{className:"comment-button",onClick:()=>r(!l),children:[s.jsx(P,{}),s.jsx("span",{className:"comment-count",children:m})]})]})}),l&&ce]})},We=()=>{const[e,a]=c.useState([]),[t,i]=c.useState(!0),[n,l]=c.useState("");return c.useEffect((()=>{(async()=>{try{i(!0);const e=(await((e={})=>{const{limit:a,offset:t,orderBy:i,userId:n}=e;let l="/api/posts?";return a&&(l+=`limit=${a}&`),t&&(l+=`offset=${t}&`),i&&(l+=`orderBy=${i}&`),n&&(l+=`userId=${n}&`),Ve(l)})({orderBy:"createdAt:desc"})).map((e=>({...e,createdAt:e.createdAt?new Date(e.createdAt):null})));a(e),l("")}catch(e){l("Ошибка при загрузке постов")}finally{i(!1)}})()}),[]),t?s.jsx("div",{className:"loading",children:"Загрузка постов..."}):n?s.jsx("div",{className:"error",children:n}):s.jsx("div",{className:"post-list",children:0===e.length?s.jsx("p",{className:"no-posts",children:"Пока нет постов. Будьте первым!"}):e.map((e=>s.jsx(Re,{post:e},e.id)))})};function Ze(){const[e,a]=c.useState(null),[t,i]=c.useState(!0);return c.useEffect((()=>{const e=Z.onAuthStateChanged((e=>{a(e),i(!1)}));return()=>e()}),[]),s.jsxs("div",{className:"_main_ptfdc_1",children:[s.jsxs("header",{className:"_main__header_ptfdc_15",children:[s.jsx("a",{href:"/",children:s.jsx(Pe,{src:"./pics/logo/sclogo",alt:"Логотип"})}),s.jsx("h1",{className:"_main__header__title_ptfdc_38",children:"soul cycle"})]}),s.jsx("nav",{className:"_main__nav_ptfdc_42",children:s.jsxs("ul",{className:"_main__nav__perexod_ptfdc_45",children:[s.jsx("li",{className:Oe,children:s.jsx(T,{to:"/",children:"Главная"})}),s.jsx("li",{className:Oe,children:s.jsx(T,{to:"/characters",children:"Персонажи"})}),s.jsx("li",{className:Oe,children:s.jsx(T,{to:"/about",children:"О нас"})})]})}),s.jsx(Je,{user:e,loading:t})]})}function Je({user:e,loading:a}){const t=F();return s.jsx(u,{mode:"wait",children:s.jsxs(G,{location:t,children:[s.jsx(V,{path:"/",element:s.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[!a&&s.jsx(Le,{}),s.jsx(We,{})]})}),s.jsx(V,{path:"/characters",element:s.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:s.jsx(Ne,{})})}),s.jsx(V,{path:"/about",element:s.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:s.jsx(Ie,{})})})]},t.pathname)})}const Ke={v:"4.8.0",meta:{g:"LottieFiles AE 1.0.0",a:"Bas Milius",k:"Meteocons, Weather icons, Icon set",d:"Clear day - Meteocons.com",tc:""},fr:60,ip:0,op:360,w:512,h:512,nm:"clear-day",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"rays",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[0]},{t:359,s:[45]}],ix:10},p:{a:0,k:[256,256,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[180,0],[130.345,0]],c:!1},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ind:1,ty:"sh",ix:2,ks:{a:0,k:{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-130.345,0],[-180,0]],c:!1},ix:2},nm:"Path 2",mn:"ADBE Vector Shape - Group",hd:!1},{ind:2,ty:"sh",ix:3,ks:{a:0,k:{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[127.279,127.279],[92.168,92.168]],c:!1},ix:2},nm:"Path 3",mn:"ADBE Vector Shape - Group",hd:!1},{ind:3,ty:"sh",ix:4,ks:{a:0,k:{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-92.168,-92.168],[-127.279,-127.279]],c:!1},ix:2},nm:"Path 4",mn:"ADBE Vector Shape - Group",hd:!1},{ind:4,ty:"sh",ix:5,ks:{a:0,k:{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-127.279,127.279],[-92.168,92.168]],c:!1},ix:2},nm:"Path 5",mn:"ADBE Vector Shape - Group",hd:!1},{ind:5,ty:"sh",ix:6,ks:{a:0,k:{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[92.168,-92.168],[127.279,-127.279]],c:!1},ix:2},nm:"Path 6",mn:"ADBE Vector Shape - Group",hd:!1},{ind:6,ty:"sh",ix:7,ks:{a:0,k:{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[0,180],[0,130.345]],c:!1},ix:2},nm:"Path 7",mn:"ADBE Vector Shape - Group",hd:!1},{ind:7,ty:"sh",ix:8,ks:{a:0,k:{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[0,-130.345],[0,-180]],c:!1},ix:2},nm:"Path 8",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[.984313726425,.749019622803,.141176477075,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:24,ix:5},lc:2,lj:1,ml:10,bm:0,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1}],ip:0,op:360,st:0,bm:0},{ddd:0,ind:2,ty:4,nm:"core",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[256,256,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,-46.392],[46.392,0],[0,46.392],[-46.392,0]],o:[[0,46.392],[-46.392,0],[0,-46.392],[46.392,0]],v:[[84,0],[0,84],[-84,0],[0,-84]],c:!0},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[.972549021244,.686274528503,.0941176489,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:6,ix:5},lc:1,lj:1,ml:10,bm:0,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"gf",o:{a:0,k:100,ix:10},r:1,bm:0,g:{p:5,k:{a:0,k:[0,.984,.749,.141,.225,.984,.749,.141,.45,.984,.749,.141,.725,.973,.684,.092,1,.961,.62,.043],ix:9}},s:{a:0,k:[-41.517,-71.871],ix:5},e:{a:0,k:[42.497,73.645],ix:6},t:1,nm:"Gradient Fill 1",mn:"ADBE Vector Graphic - G-Fill",hd:!1}],ip:0,op:360,st:0,bm:0}],markers:[]},Qe={v:"5.5.8",fr:29.9700012207031,ip:0,op:160.000006516934,w:150,h:150,nm:"icon_moon",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"moon Outlines",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[77.728,68.567,0],ix:2},a:{a:0,k:[583,600,0],ix:1},s:{a:0,k:[45,45,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,13.612],[-13.612,0],[0,0],[0,4.127],[-13.613,0],[0,0],[0,-13.612],[13.613,0],[0,0],[0,-4.127],[13.613,0]],o:[[-13.612,0],[0,-13.613],[0,0],[-1.971,-3.611],[0,-13.612],[0,0],[13.613,0],[0,13.614],[0,0],[1.971,3.611],[0,13.612],[0,0]],v:[[-57.605,42.935],[-82.292,18.248],[-57.605,-6.44],[-27.961,-6.44],[-30.971,-18.248],[-6.283,-42.935],[57.604,-42.935],[82.292,-18.248],[57.604,6.441],[27.961,6.441],[30.97,18.248],[6.282,42.935]],c:!0},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"fl",c:{a:0,k:[.733333349228,.96862745285,1,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[504.292,658.677],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transformer "}],nm:"Group 5",np:2,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tr",p:{a:1,k:[{i:{x:.833,y:.833},o:{x:.167,y:.167},t:0,s:[504.291,658.677],to:[-3.333,0],ti:[0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:40,s:[484.291,658.677],to:[0,0],ti:[0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:80,s:[504.291,658.677],to:[0,0],ti:[0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:120,s:[484.291,658.677],to:[0,0],ti:[-3.333,0]},{t:160.000006516934,s:[504.291,658.677]}],ix:2},a:{a:0,k:[480.291,623.677],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transformer "}],nm:"c1",np:1,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,7.3],[-7.3,0],[0,0],[0,-7.3],[7.299,0]],o:[[-7.3,0],[0,-7.3],[0,0],[7.299,0],[0,7.3],[0,0]],v:[[-49.017,13.239],[-62.255,.001],[-49.017,-13.238],[49.017,-13.238],[62.255,.001],[49.017,13.239]],c:!0},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"fl",c:{a:0,k:[.733333349228,.96862745285,1,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[608.408,572.45],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transformer "}],nm:"Group 9",np:2,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tr",p:{a:1,k:[{i:{x:.833,y:.833},o:{x:.167,y:.167},t:0,s:[608.408,572.45],to:[2.361,0],ti:[-5.079,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:33,s:[624.897,572.45],to:[2.092,0],ti:[0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:40,s:[628.408,572.45],to:[0,0],ti:[0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:80,s:[608.408,572.45],to:[0,0],ti:[0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:120,s:[628.408,572.45],to:[0,0],ti:[3.333,0]},{t:160.000006516934,s:[608.408,572.45]}],ix:2},a:{a:0,k:[608.408,548.45],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transformer "}],nm:"c2",np:1,cix:2,bm:0,ix:2,mn:"ADBE Vector Group",hd:!1},{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[23.394,0],[0,61.75],[-15.662,19.738],[-24.17,5.763],[2.294,-4.352],[0,-15.361],[-51.493,0],[-11.283,4.614],[1.603,-4.652],[19.108,-13.726]],o:[[-61.75,0],[0,-25.147],[15.552,-19.598],[4.785,-1.142],[-7.101,13.467],[0,51.492],[12.2,0],[4.556,-1.863],[-7.555,21.932],[-19.251,13.829]],v:[[2.221,111.03],[-109.767,-.958],[-85.479,-70.561],[-23.882,-109.888],[-17.49,-101.649],[-28.191,-58.205],[65.193,35.178],[100.583,28.225],[108.163,35.387],[67.407,89.892]],c:!0},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"fl",c:{a:0,k:[1,.831372559071,.352941185236,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[599.388,602.031],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transformer "}],nm:"banana",np:2,cix:2,bm:0,ix:3,mn:"ADBE Vector Group",hd:!1},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,6.708],[-6.708,0],[0,0],[0,0],[1.729,-4.168],[0,0]],o:[[-6.708,0],[0,-6.708],[0,0],[0,0],[-2.247,3.961],[0,0],[0,0]],v:[[-13.228,12.165],[-25.393,0],[-13.228,-12.165],[25.393,-12.165],[20.546,-3.616],[14.555,8.634],[13.089,12.165]],c:!0},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"fl",c:{a:0,k:[.733333349228,.96862745285,1,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:1,k:[{i:{x:.833,y:.833},o:{x:.167,y:.167},t:0,s:[474.245,549.909],to:[3.333,0],ti:[0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:40,s:[494.245,549.909],to:[0,0],ti:[0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:80,s:[474.245,549.909],to:[0,0],ti:[0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:120,s:[494.245,549.909],to:[0,0],ti:[3.333,0]},{t:160.000006516934,s:[474.245,549.909]}],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transformer "}],nm:"Group 14",np:2,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tr",p:{a:0,k:[484.245,549.909],ix:2},a:{a:0,k:[475.245,549.909],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transformer "}],nm:"c3",np:1,cix:2,bm:0,ix:4,mn:"ADBE Vector Group",hd:!1}],ip:0,op:1798.00007323404,st:0,bm:0}],markers:[]},Xe={themeButton:"_themeButton_1oj5n_1"},Ye=p.memo((()=>{const{theme:e,toggleTheme:a}=c.useContext(ye),[t,i]=c.useState(!1),n=c.useMemo((()=>({animationData:"dark"===e?Ke:Qe,loop:!0,autoplay:!0})),[e]),l=c.useCallback((()=>{t||(a(),i(!0),setTimeout((()=>{i(!1)}),3e3))}),[t,a]);return s.jsx("button",{className:`${Xe.themeButton} ${t?Xe.disabled:""}`,onClick:l,disabled:t,"aria-label":"dark"===e?"Switch to Light Mode":"Switch to Dark Mode",children:s.jsx(j,{config:n,speed:1,style:{width:"35px",height:"35px",display:"block"}})})}));Ye.displayName="ThemeToggleButton";const ea=()=>{r(Z,(e=>{e&&(async e=>{if(e)try{await Ge("/api/users/sync",{method:"POST"})}catch(la){}})(e)}))},aa=({userId:e,nickname:a})=>{const[t,i]=c.useState({className:"",style:{}}),[n,l]=c.useState(!0);return c.useEffect((()=>{if(!e)return void l(!1);const a=q(M(K,"users",e),(e=>{if(e.exists())switch(e.data().activePrivilege||"nickname"){case"admin":i({className:"admin-name",style:{color:"#FFD700",fontWeight:600}});break;case"early-user":i({className:"early-user-name",style:{color:"#FF4444",fontWeight:500}});break;case"custom-title":i({className:"custom-title-name",style:{color:"#4A90E2",fontWeight:500}});break;default:i({className:"default-name",style:{color:"#2c3e50",fontWeight:400}})}l(!1)}));return()=>a()}),[e]),n?s.jsx("span",{className:"user-name loading",children:a}):s.jsx("div",{className:`user-name-container ${t.className}`,children:s.jsxs("span",{className:"user-name",children:[(()=>{switch(t.className){case"admin-name":return s.jsx(C,{className:"privilege-icon",style:{color:"#FFD700"}});case"early-user-name":return s.jsx(B,{className:"privilege-icon",style:{color:"#FF4444"}});case"custom-title-name":return s.jsx(S,{className:"privilege-icon",style:{color:"#4A90E2"}});default:return null}})(),s.jsx("span",{style:t.style,children:a})]})})},ta=({userId:e})=>{const[a,t]=c.useState(null),[i,n]=c.useState(null),[l,r]=c.useState([]),[o,d]=c.useState(!0),[m,h]=c.useState(!1);c.useEffect((()=>{if(!e)return void d(!1);const a=q(M(K,"users",e),(a=>{if(a.exists()){const i=a.data(),l=i.activePrivilege||"nickname",c=[];c.push({id:"nickname",name:"Пользователь",icon:s.jsx(A,{}),description:"Показывать ваш никнейм"}),i.isAdmin&&c.push({id:"admin",name:"Администратор",icon:s.jsx(C,{}),description:"Показывать статус администратора"}),i.isEarlyUser&&c.push({id:"early-user",name:"Ранний пользователь",icon:s.jsx(B,{}),description:"Показывать статус раннего пользователя"}),i.customTitle&&c.push({id:"custom-title",name:i.customTitle,icon:s.jsx(S,{}),description:"Показывать ваш особый титул"}),r(c),c.some((e=>e.id===l))?n(l):(L(M(K,"users",e),{activePrivilege:"nickname"}).catch((e=>{t("Не удалось обновить статус")})),n("nickname"))}d(!1)}));return()=>a()}),[e]);const u=c.useMemo((()=>s.jsx("div",{className:"privileges-list",children:l.map((a=>s.jsxs("div",{className:"privilege-item "+(i===a.id?"active":""),onClick:()=>(async a=>{if(a!==i){h(!0);try{await L(M(K,"users",e),{activePrivilege:a})}catch(n){t("Не удалось обновить статус")}finally{h(!1)}}})(a.id),"data-id":a.id,children:[s.jsx("span",{className:"privilege-icon",children:a.icon}),s.jsx("span",{className:"privilege-name",children:a.name}),i===a.id&&s.jsx("span",{className:"active-indicator",children:"Активен"})]},a.id)))})),[l,i]);return o?s.jsx("div",{className:"loading",children:"Загрузка статусов..."}):a?s.jsx("div",{className:"error",children:a}):0===l.length?s.jsx("div",{className:"no-data",children:"Нет доступных статусов"}):s.jsxs("div",{className:"user-privileges",children:[s.jsx("h3",{children:"Выбор отображаемого статуса"}),s.jsx("p",{className:"privilege-description",children:"Выберите, какой статус будет отображаться рядом с вашим именем в постах и комментариях. В один момент может отображаться только один статус."}),u,m&&s.jsx("div",{className:"saving",children:"Сохранение..."})]})},ia=()=>{const[e,a]=c.useState(!0),[t,i]=c.useState(""),[n,l]=c.useState(""),[u,_]=c.useState(""),[p,y]=c.useState(""),[v,f]=c.useState(null),[g,k]=c.useState(null),[b,N]=c.useState(!1),w=c.useRef(null),{isAdmin:x}=Me(null==v?void 0:v.uid);c.useEffect((()=>{ea();const e=r(Z,(async e=>{f(e),(null==e?void 0:e.displayName)&&_(e.displayName)})),a=e=>{w.current&&!w.current.contains(e.target)&&N(!1)};return document.addEventListener("mousedown",a),()=>{e(),document.removeEventListener("mousedown",a)}}),[]),c.useEffect((()=>{if(!v)return void k(null);const e=q(M(K,"users",v.uid),(e=>{e.exists()?k(e.data()):k(null)}),(e=>{k(null)}));return()=>e()}),[v]);const $=()=>{N(!b)};return v?((e=>{if(!e)return!1;const a=new Date(e),t=new Date("2024-04-10");a.getTime(),t.getTime()})(v.metadata.creationTime),s.jsxs("div",{className:"auth-container",ref:w,children:[s.jsx("div",{className:"user-icon",onClick:$,children:v.displayName?v.displayName[0].toUpperCase():v.email[0].toUpperCase()}),b&&s.jsxs("div",{className:"auth-form",children:[s.jsxs("div",{className:"profile-info",children:[s.jsx("div",{className:"nickname-container",children:s.jsx(aa,{userId:v.uid,nickname:v.displayName||"Пользователь"})}),s.jsx("p",{className:"profile-email",children:v.email}),s.jsxs("p",{className:"profile-date",children:["Зарегистрирован: ",(A=v.metadata.creationTime,A?new Date(A).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}):"")]}),x&&s.jsx("p",{className:"admin-status",children:"Статус: Администратор"}),s.jsx("div",{className:"privileges-section",children:s.jsx(ta,{userId:v.uid})})]}),s.jsx("button",{onClick:async()=>{try{await o(Z),N(!1)}catch(e){y(e.message)}},className:"sign-out-button",children:"Выйти"})]})]})):s.jsxs("div",{className:"auth-container",ref:w,children:[s.jsx("div",{className:"auth-icon",onClick:$,children:"👤"}),b&&s.jsxs("div",{className:"auth-form",children:[s.jsx("h2",{children:e?"Вход":"Регистрация"}),p&&s.jsx("div",{className:"error",children:p}),s.jsxs("form",{onSubmit:async a=>{a.preventDefault(),y("");try{if(e)await d(Z,t,n);else{const e=await m(Z,t,n);await h(e.user,{displayName:u}),await H(M(K,"users",e.user.uid),{email:t,displayName:u,createdAt:(new Date).toISOString(),isAdmin:!1})}}catch(i){y(i.message)}},children:[!e&&s.jsx("input",{type:"text",placeholder:"Ник",value:u,onChange:e=>_(e.target.value),required:!0}),s.jsx("input",{type:"email",placeholder:"Email",value:t,onChange:e=>i(e.target.value),required:!0}),s.jsx("input",{type:"password",placeholder:"Пароль",value:n,onChange:e=>l(e.target.value),required:!0}),s.jsx("button",{type:"submit",children:e?"Войти":"Зарегистрироваться"})]}),s.jsx("button",{className:"toggle-button",onClick:()=>a(!e),children:e?"Нет аккаунта? Зарегистрироваться":"Уже есть аккаунт? Войти"})]})]});var A};function na(){return s.jsx(U,{children:s.jsx(X,{children:s.jsxs("div",{className:"_page_19xob_109",children:[s.jsx(Ye,{}),s.jsx(ia,{}),s.jsx(Ze,{})]})})})}z.createRoot(document.getElementById("root")).render(s.jsxs(fe,{children:[" ",s.jsx(na,{})]}));
